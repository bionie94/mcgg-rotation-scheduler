<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Magic Chess : GO GO Predict</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center py-6">
  <h1 class="text-3xl font-bold mb-2">
    âœ¨ <span class="bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 bg-clip-text text-transparent">
      Magic Chess : GO GO Predict
    </span>
  </h1>
  <p class="mb-6 text-gray-400">Masukkan 8 nama pemain (P1 = Kamu).</p>

  <!-- Player Inputs -->
  <div id="playerInputs" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"></div>

  <div class="flex gap-4 mb-6">
    <button id="btnGenerate" class="px-4 py-2 rounded bg-indigo-600 hover:bg-indigo-700">ğŸ® Generate Rounds</button>
    <button id="btnClear" class="px-4 py-2 rounded bg-gray-600 hover:bg-gray-700">ğŸ§¹ Reset Inputs</button>
  </div>

  <!-- Rounds -->
  <form id="roundsForm" class="hidden w-full max-w-xl mx-auto mb-6">
    <h2 class="text-lg font-semibold mb-2">ğŸ“ Isi Lawan (Round)</h2>
    <div id="rounds" class="flex flex-col gap-2"></div>
    <button id="btnSolve" type="button" class="mt-4 px-4 py-2 rounded bg-green-600 hover:bg-green-700">
      ğŸš€ Find Opponent Sequence
    </button>
  </form>

  <!-- Output -->
  <div id="outputSection" class="hidden w-full max-w-4xl mx-auto">
    <h2 class="text-lg font-semibold mb-2">ğŸ“„ Hasil Prediksi</h2>
    <div id="output" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
    <p class="text-sm text-gray-400 mt-2">Format: Kemungkinan 1 (kiri) dan Kemungkinan 2 (kanan).</p>
  </div>

<script>
window.onload = () => {
  const cont = document.getElementById("playerInputs");
  cont.innerHTML = "";
  for (let i = 1; i <= 8; i++) {
    const wrapper = document.createElement("div");
    wrapper.className = "flex flex-col";
    wrapper.innerHTML = `
      <label for="P${i}" class="text-sm text-gray-300 mb-1 select-none">P${i} ${i===1 ? "(You)" : ""}</label>
      <input id="P${i}" type="text"
             class="px-3 py-2 rounded bg-gray-700 border border-gray-600 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-gray-200"
             placeholder="Player ${i} name" ${i===1 ? "autofocus" : ""}/>
    `;
    cont.appendChild(wrapper);
  }
};

let players = [];

// Generate rounds
document.getElementById("btnGenerate").addEventListener("click", generateDropdowns);
document.getElementById("btnClear").addEventListener("click", () => { window.onload(); });

function generateDropdowns() {
  players = [];
  for (let i = 1; i <= 8; i++) {
    const v = document.getElementById("P"+i).value.trim() || i.toString();
    players.push(v);
  }

  const titles = ["I-2","I-3","I-4","II-1","II-2"];
  const roundsDiv = document.getElementById("rounds");
  roundsDiv.innerHTML = "";

  titles.forEach((title, idx) => {
    const row = document.createElement("div");
    row.className = "flex items-center gap-3 bg-gray-700 p-3 rounded";

    row.innerHTML = `
      <div class="w-16 text-sm text-gray-300">${title}</div>
      <input type="text" value="${players[0]}" disabled
             class="px-3 py-2 rounded bg-gray-800 border border-gray-700 text-gray-400 w-20 text-center"/>
      <div class="text-gray-300 font-medium">vs</div>
      <select class="px-3 py-2 rounded bg-gray-800 border border-gray-700 text-gray-200 w-full" data-index="${idx}">
        <option value="">-- pilih lawan --</option>
        ${players.slice(1).map(p => `<option value="${p}">${p}</option>`).join("")}
      </select>
    `;
    roundsDiv.appendChild(row);
  });

  document.getElementById("roundsForm").classList.remove("hidden");
  document.getElementById("outputSection").classList.add("hidden");
}

// Solve
document.getElementById("btnSolve").addEventListener("click", solve);

function solve() {
  const selects = Array.from(document.querySelectorAll("#rounds select"));
  const chosen = selects.map(s => s.value).filter(v => v);

  if (chosen.length < 5) {
    alert("Isi semua 5 ronde terlebih dahulu.");
    return;
  }

  // semua pemain selain P1
  const others = players.slice(1);

  // cari baki (remaining)
  const remaining = others.filter(p => !chosen.includes(p));

  // pattern title rounds
  const titles = ["II-4","II-5","II-6","III-1","III-2","III-4","III-5","III-6","IV-1","IV-2","IV-4","IV-5"];

  // hasil clone pattern asal PHP â†’ rotate 2 kemungkinan
  const seq1 = [];
  const seq2 = [];

  titles.forEach((title, i) => {
    if (i < remaining.length) {
      seq1.push(`${title} : ${remaining[i]}`);
      seq2.push(`${title} : ${remaining[remaining.length - 1 - i]}`);
    } else {
      const idx = (i - remaining.length) % chosen.length;
      seq1.push(`${title} : ${chosen[idx]}`);
      seq2.push(`${title} : ${chosen[chosen.length - 1 - idx]}`);
    }
  });

  const output = document.getElementById("output");
  output.innerHTML = `
    <div class="bg-gray-900 rounded p-4 border border-gray-700">
      <h3 class="text-indigo-300 font-semibold mb-2">Kemungkinan 1</h3>
      <pre class="text-green-400 font-mono text-sm">${seq1.join("\n")}</pre>
    </div>
    <div class="bg-gray-900 rounded p-4 border border-gray-700">
      <h3 class="text-indigo-300 font-semibold mb-2">Kemungkinan 2</h3>
      <pre class="text-green-400 font-mono text-sm">${seq2.join("\n")}</pre>
    </div>
  `;
  document.getElementById("outputSection").classList.remove("hidden");
}
</script>
</body>
</html>

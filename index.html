<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>âœ¨ Magic Chess : GO GO Predict</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center py-6">

  <h1 class="text-3xl font-bold mb-2">
    <span class="bg-gradient-to-r from-pink-400 via-purple-400 to-indigo-400 bg-clip-text text-transparent">
      âœ¨ Magic Chess : GO GO Predict
    </span>
  </h1>
  <p class="mb-6 text-gray-400">Masukkan 8 nama pemain (P1 = Kamu).</p>

  <!-- Player inputs -->
  <div id="playerInputs" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 w-full max-w-3xl"></div>

  <!-- Buttons -->
  <div class="flex gap-4 mb-8">
    <button id="btnGenerate" class="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded font-semibold">ðŸŽ® Generate Rounds</button>
    <button id="btnClear" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded font-semibold">ðŸ§¹ Reset Inputs</button>
  </div>

  <!-- Rounds -->
  <div id="roundsForm" class="hidden w-full max-w-2xl">
    <h2 class="text-lg font-semibold mb-2">ðŸ“‹ Isi Lawan (Round)</h2>
    <div id="rounds" class="flex flex-col gap-3"></div>
    <button id="btnSolve" class="mt-4 bg-green-600 hover:bg-green-700 px-4 py-2 rounded font-semibold">ðŸš€ Find Opponent Sequence</button>
  </div>

  <!-- Output -->
  <div id="outputSection" class="hidden w-full max-w-3xl mt-6">
    <h2 class="text-lg font-semibold mb-2">ðŸ“˜ Hasil Prediksi</h2>
    <div id="output" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
    <p class="text-gray-400 text-sm mt-2">Format: Kemungkinan 1 (kiri) dan Kemungkinan 2 (kanan).</p>
  </div>

<script>
window.onload = () => {
  const cont = document.getElementById("playerInputs");
  cont.innerHTML = "";
  for (let i = 1; i <= 8; i++) {
    const wrap = document.createElement("div");
    wrap.innerHTML = `
      <label class="block text-sm mb-1">P${i} ${i===1?"(You)":""}</label>
      <input id="P${i}" type="text" placeholder="Player ${i}" 
             class="w-full px-3 py-2 rounded bg-gray-700 border border-gray-600" />
    `;
    cont.appendChild(wrap);
  }
};

let players = [];
document.getElementById("btnClear").addEventListener("click", () => location.reload());

// Generate dropdowns
document.getElementById("btnGenerate").addEventListener("click", () => {
  players = [];
  for (let i=1;i<=8;i++){
    const v = document.getElementById("P"+i).value.trim();
    if(!v){ alert("Semua nama mesti diisi."); return; }
    players.push(v);
  }
  if(new Set(players.map(x=>x.toLowerCase())).size!==8){ alert("Nama mesti unik."); return; }

  const titles=["I-2","I-3","I-4","II-1","II-2"];
  const roundsDiv=document.getElementById("rounds");
  roundsDiv.innerHTML="";
  titles.forEach((t,idx)=>{
    const row=document.createElement("div");
    row.className="flex items-center gap-3 bg-gray-800 p-3 rounded";
    row.innerHTML=`
      <div class="w-16">${t}</div>
      <input value="${players[0]}" disabled class="w-24 px-2 py-1 rounded bg-gray-700"/>
      <div>vs</div>
      <select data-index="${idx}" class="flex-1 px-2 py-1 rounded bg-gray-700"></select>
    `;
    roundsDiv.appendChild(row);
  });
  updateDropdowns();
  document.querySelectorAll("#rounds select").forEach(sel=>sel.addEventListener("change",updateDropdowns));
  document.getElementById("roundsForm").classList.remove("hidden");
});

// update dropdowns
function updateDropdowns(){
  const selects=[...document.querySelectorAll("#rounds select")];
  const used=selects.map(s=>s.value).filter(v=>v);
  selects.forEach(sel=>{
    const cur=sel.value;
    sel.innerHTML=`<option value="">-- pilih lawan --</option>`+
      players.filter(p=>p!==players[0] && (!used.includes(p)||p===cur))
             .map(p=>`<option value="${p}" ${p===cur?"selected":""}>${p}</option>`).join("");
  });
}

// Solve button
document.getElementById("btnSolve").addEventListener("click",()=>{
  const selects=[...document.querySelectorAll("#rounds select")];
  const chosen=selects.map(s=>s.value);
  if(chosen.includes("")){ alert("Isi semua 5 lawan dulu."); return; }

  const used=new Set(chosen);
  const remaining=players.filter(p=>p!==players[0] && !used.has(p));
  if(remaining.length!==2){ alert("Sisa lawan tak cukup."); return; }

  const seq1=[],seq2=[];
  // II-4, II-5 = baki lawan
  seq1.push(`II-4 : ${remaining[0]}`);
  seq1.push(`II-5 : ${remaining[1]}`);
  seq2.push(`II-4 : ${remaining[1]}`);
  seq2.push(`II-5 : ${remaining[0]}`);

  // II-6..IV-5 ikut mapping asal (ulang dari chosen)
  const mapping=["I-2","I-3","I-4","II-1","II-2"];
  let roundList=["II-6","III-1","III-2","III-4","III-5","III-6","IV-1","IV-2","IV-4","IV-5"];
  roundList.forEach((r,i)=>{
    seq1.push(`${r} : ${chosen[i%chosen.length]}`);
    seq2.push(`${r} : ${chosen[i%chosen.length]}`);
  });

  const output=document.getElementById("output");
  output.innerHTML="";
  const makeCard=(title,seq)=>`
    <div class="bg-gray-800 p-4 rounded border border-gray-700">
      <h3 class="text-indigo-300 font-semibold mb-2">${title}</h3>
      <pre class="text-green-400 text-sm">${seq.join("\n")}</pre>
    </div>`;
  output.innerHTML=makeCard("Kemungkinan 1",seq1)+makeCard("Kemungkinan 2",seq2);
  document.getElementById("outputSection").classList.remove("hidden");
});
</script>
</body>
</html>
